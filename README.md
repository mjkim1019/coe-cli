# Swing CLI

Swing CLI는 LLM 백엔드 서비스와 통신하여 코드에 대해 질문하고 수정을 요청할 수 있는 대화형 CLI 도구입니다.

## 주요 기능

- **대화형 REPL 인터페이스**: 사용자와 상호작용하며 명령을 입력받습니다.
- **컨텍스트 기반 파일 관리**: `/add` 명령어로 로컬 파일을 LLM의 작업 컨텍스트에 추가할 수 있습니다.
- **작업 모드 전환**: `/ask` (코드 분석 및 질문) 모드와 `/edit` (코드 수정 요청) 모드를 지원하여 명확한 작업을 수행할 수 있습니다.
- **다양한 편집 전략**: wholefile, editblock, udiff 세 가지 편집 방식으로 상황에 맞는 최적화된 코드 수정이 가능합니다.
- **백엔드 연동**: 백엔드 LLM 서비스와 통신하여 지능적인 응답을 제공합니다.

## 아키텍처

`coe-cli`는 사용자의 입력을 받아 백엔드 서버로 전달하는 **클라이언트**와, 실제 LLM 호출을 처리하는 **백엔드**로 구성된 클라이언트-서버 아키텍처를 따릅니다. 원활한 사용을 위해 백엔드 서버가 먼저 실행되어야 합니다.

## 사전 준비 사항

- Python 3.8 이상
- Docker 및 Docker Compose

## 설치 및 실행 방법

### 1. 백엔드 서버 실행

`coe-cli`는 Docker Compose를 사용하여 백엔드 환경을 실행합니다. 프로젝트 루트 디렉토리에서 다음 명령어를 실행하세요.

```bash
docker-compose up -d
```

### 2. 클라이언트(coe-cli) 설정

백엔드 서버가 실행된 후, 별도의 터미널에서 다음 단계를 따라 클라이언트를 설정합니다.

#### 가상 환경 생성 및 활성화

```bash
# 가상 환경 생성 (최초 한 번)
python3 -m venv .venv

# 가상 환경 활성화 (새 터미널을 열 때마다)
source .venv/bin/activate
```

#### 필요 라이브러리 설치

```bash
# 가상 환경이 활성화된 상태에서 실행
pip3 install -r requirements.txt
```

### 3. Swing CLI 실행

모든 설정이 완료되면 다음 명령어로 `Swing CLI`를 시작합니다.

```bash
python3 cli/main.py
```

## 사용법

`Swing CLI`가 실행되면 프롬프트(`>`)가 나타납니다.

1.  **파일 추가**: `/add` 명령어로 분석하거나 수정할 파일을 컨텍스트에 추가합니다.
    ```
    > /add path/to/your_file.py
    ```

2.  **모드 선택**: `/ask` 또는 `/edit`으로 작업 모드를 설정합니다.
    ```
    > /ask                    # 질문 모드
    > /edit                   # 기본 편집 모드 (wholefile)
    > /edit udiff             # 정밀 수정 (한두줄 오타 등)
    > /edit editblock         # 함수/블록 교체
    ```

3.  **질문 또는 요청**: 원하는 내용을 입력합니다.
    ```
    > 이 파일의 주요 기능은 무엇인가요?        # ask 모드
    > print 오타 수정해줘                     # edit udiff 모드  
    > User 클래스 추가해줘                    # edit wholefile 모드
    ```

### 명령어 목록

| 명령어 | 설명 |
| --- | --- |
| `/add <files...>` | 하나 이상의 파일을 LLM 컨텍스트에 추가합니다. |
| `/ask` | 코드에 대해 질문하는 'ask' 모드로 전환합니다. |
| `/edit` | 코드 수정을 요청하는 'edit' 모드로 전환합니다 (기본: wholefile). |
| `/edit <전략>` | 특정 편집 전략으로 모드 전환 (wholefile/editblock/udiff). |
| `/preview` | 마지막 edit 응답의 변경사항 미리보기 |
| `/apply` | 변경사항을 실제 파일에 적용 |
| `/help` | 사용 가능한 모든 명령어를 보여줍니다. |
| `/exit` | CLI를 종료합니다. |

## 편집 전략별 특징

| 전략 | 적합한 상황 | 예시 |
| --- | --- | --- |
| **wholefile** | 새 파일 생성, 대규모 변경 | 새 클래스 추가, 파일 구조 변경 |
| **editblock** | 특정 함수/블록 수정 | 함수 로직 변경, 메서드 추가 |  
| **udiff** | 정밀한 라인 수정 | 오타 수정, 한두줄 변경 |
